---
title: 3. How can I know DEGs?
author: Ryo Niwa
date: 2024-08-28
category: RNA-Seq
layout: post
mermaid: true
---

> ##### Aim for this page
> Understand methods to process a count matrix data
{: .block-tip }

## Quick answer of this page: DESeq2/edgeR

Once you obtain a count matrix, there are a couple of tools available to process the count matrix to extract DEGs (differentially expressed genes). The big two legends in this field are edgeR and DESeq2, cited almost 40000 and 70000 times respectively.

**Robinson MD, McCarthy DJ, Smyth GK. edgeR: a Bioconductor package for differential expression analysis of digital gene expression data. Bioinformatics. 2010 Jan 1;26(1):139-40. doi: 10.1093/bioinformatics/btp616.**

**Love, M.I., Huber, W. & Anders, S. Moderated estimation of fold change and dispersion for RNA-seq data with DESeq2. Genome Biol 15, 550 (2014). https://doi.org/10.1186/s13059-014-0550-8**

But why do we need to use this kind of tools? [The training seminar at the Harvard Chan Bioinformatics Core](https://hbctraining.github.io/DGE_workshop_salmon/lessons/05_DGE_DESeq2_analysis2.html) documents the uniqueness of RNA-Seq statistics as follows. 

> the count data generated by RNA-seq exhibits overdispersion (variance > mean) and the statistical distribution used to model the counts needs to account for this overdispersion.

The Poisson distribution is commonly used for standard count data and is suitable for data with low variability. However, for data like RNA-Seq, where expression levels can vary greatly depending on conditions, the Poisson distribution is not appropriate. The negative binomial distribution can handle greater variability than the Poisson distribution, making it more suitable for RNA-Seq count data.

For comparing gene expression between samples using visualizations such as box plots or scatter plots, normalization to TPM (Transcripts Per Million) is convenient. However, DESeq2 and edgeR use different assumptions and perform their own internal normalization. Therefore, when using these tools, it is necessary to provide raw count matrices.

DESeq2 uses median of ratios as internal normalization method and edgeR deploys trimmed mean of M values (TMM). Both of the methods are considered reliable, but their assumptions are different. 

| Aspect | DESeq2's Median of Ratios | edgeR's Trimmed Mean of M-values (TMM) |
|--------|---------------------------|----------------------------------------|
| **Approach** | Uses the median of ratios of gene counts between samples. | Calculates the log-fold changes (M-value), trims genes with the extreme M values, and then computes the mean of the trimmed M-values. |
| **Robustness** | Handles outliers and large numbers of differentially expressed genes well. | Reduces the impact of outliers and adjusts for differences in sequencing depth and composition. |

Both packages have appropriate Hypothesis testing and Multiple test correction like Wald test and Benjamini-Hochberg in DESeq2. The packages spit out DEGs over your defined thereshold. 
