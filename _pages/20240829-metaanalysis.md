---
title: RNASeqChef
author: Ryo Niwa
date: 2024-08-22
category: Packages
layout: post
---

# NCBI GEOを使ってメタ解析を行う
#### Documented by Ryo Niwa

### メタ解析のワークフロー

## Bulk RNA-Seqメタ解析の重要ステップ

## 1. データ収集
- **公的データベースの利用**: GEO (Gene Expression Omnibus) から取得する

- **データセットの選択基準の設定**: 研究目的に合わせて、条件（例：組織タイプ、疾病状態、技術的変数など）を決定する。基本的に比較する際は、合わせられるものは統一したほうが良い。RNA-Seqはただでさえばらつくので、生物種や細胞株など統一可能な範囲では努力する。

- **AIツールに頼る**:ResearchRabbit, ConnectedPapersあたりは非常に優れている。


## 2. データ前処理
- **TSVファイルの確認**: GEOからダウンロードしたTSVファイルを確認し、必要なメタデータを取得する。2023年ごろよりGEOに登録されたヒト検体RNA-Seqは全てNCBIが規格化された手法で解析し、登録後1週間程度でカウントデータがアップされている。

参考1: https://www.ncbi.nlm.nih.gov/geo/info/rnaseqcounts.html
参考2: https://academic.oup.com/nar/article/52/D1/D138/7337616

:::info
SRAの実行データのうち、生物種がヒト（Homo sapiens）で、タイプがトランスクリプトミクスのものは、HISAT2を用いてゲノムアセンブリGCA_000001405.15にアライメントされる。50%以上のアライメント率を達成した実行データは、SubreadのfeatureCountsでさらに処理され、各実行データに対する生データカウントファイルが生成される。

生データカウントマトリックス内の値は、一般的な差次的発現解析ソフトウェアに適した入力となるように四捨五入される。GEOは、生データカウントを入力として、FPKM(RPKM)およびTPMで規格化された値を計算する。
:::

## 3. データセットの結合
- **Rなどで行う**: Rなどを用いて、データセットを結合する。Excelで力技でやっても構わない。RNA-Seqに存在するBatch effectを修正して解析を行う場合もあるが、大体の結論を導き出すだけであれば基本的には不要。

- **最低限のQC**: DegustやiDEPなどを用いて全体を俯瞰し、解析している検体が確からしいかどうかを見ておくと良い。これらを使ってDEGsを見ても良いが、今回は必要なさそうなので割愛。GEO2Rでも中身は確認できるので、それでもOK。全体のカウント値が大幅に外れていなければ問題ない。
https://togotv.dbcls.jp/en/20230328.html


