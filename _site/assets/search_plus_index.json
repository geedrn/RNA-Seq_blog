{"/others/how_I_build_this_website/": {
    "title": "How I built this website",
    "keywords": "Website",
    "url": "/others/how_I_build_this_website/",
    "body": "This website is powered by jekyll-gitbook. I simply forked the repository from the github and pasted them into my own repo. I use docker-ed jekyll for local procedures,. Here is my typicall command for a quick check after updating markdown. docker run --rm \\ --volume=\"$PWD:/srv/jekyll:Z\" \\ --publish 127.0.0.1:4000:4000 \\ -it jekyll/jekyll:4.2.0 \\ sh -c \"bundle install &amp;&amp; jekyll serve\" I used remote theme function supported on Github pages. See details from the link. jekyll-gitbook is open sourced under the Apache License, Version 2.0, using the same license as the original GitBook repository."
  },"/pages/20240828-RNASeqChef/": {
    "title": "RNASeqChef",
    "keywords": "Packages",
    "url": "/pages/20240828-RNASeqChef/",
    "body": "Description Ref: Github Ref: A web-based integrative transcriptome analysis, RNAseqChef, uncovers the cell/tissue type-dependent action of sulforaphane RNAseqChef, RNA-seq data controller highlighting gene expression features, a web-based platform of systematic transcriptome analysis which can automatically detect, integrate, and visualize the differentially expressed genes and their biological function without bioinformatics skills. Furthermore, Users can analyze not only a single dataset but also integrate and evaluate multiple datasets. Docker commands docker run --rm -p 3838:3838 omicschef/rnaseqchef:latest JPN demo: YouTube Pros Ongoing maintenance Great visualization in pair-wise or 3 conditions DEG Actions are light Can manage promoter motif analysis TogoTV is available in Japanese Cons Difficulty in multi DEGs Less citations Only Japanese movie manual available"
  },"/pages/20240828-docker/": {
    "title": "Docker make you life easier",
    "keywords": "Packages",
    "url": "/pages/20240828-docker/",
    "body": "Ref: https://www.docker.com/ Aim for this page Understand how to use docker Quick answer of this page: No quick answer to this post. Take a training! Core RNA-Seq tools like DESeq2 and edgeR are implemented in R. As a result, many RNA-Seq web applications are primarily implemented in R as well. When creating web applications in R, developers often use a package called Shiny. However, one of the issues with these tools is that they can be somewhat slow in operation. To address this, instead of accessing a web server to use RNA-Seq web applications, this post introduces a method to run these web applications on a local computer via Docker. Docker Docker is a powerful platform designed to streamline the process of developing, shipping, and running applications by encapsulating them in lightweight, portable containers. These containers are essentially standalone, executable packages that include everything needed to run the application: code, runtime, system tools, libraries, and settings. Docker utilizes containerization technology to create isolated environments that can run consistently across various computing infrastructures, from a developer’s local machine to test environments and production servers. This isolation ensures that the application works uniformly regardless of the host environment, effectively addressing the common “it works on my machine” problem. Long story in short, if I make a docker image on my computer and share it with you, you can copy identical environment what I have in your computer. Docker Desktop Docker Desktop is a software application designed to manage Docker containers through a user-friendly graphical interface. It provides an accessible way for developers and researchers to interact with Docker, especially on personal computers. By default, when Docker Desktop is launched, it reserves 2 CPU cores and 8GB of RAM exclusively for Docker operations. This ensures that Docker containers have dedicated resources to run efficiently. Download and try the app from here: https://www.docker.com/products/docker-desktop/ Then copy and paste this command: docker run -d -p 80:80 docker/getting-started After executing the command, docker automatically downloads required image. Go to localhost:80. Now you copied an environment from docker labs and can see a website running locally (which means you are browsing the files in your computer). You can disconnect your WiFi and see whether the website lasts if you do not trust me. Many websites use docker as a base and put the container on servers like AWS. That’s how website and web applications work. Docker Hub To execute the same process for RNA-Seq web application, docker images need to be uploaded somewhere or you have to make them by your own. Making docker images on your own takes a bit of studies and I do not introduce the methods in this post. Instead you can focus on tools that developers made images open. The somewhere developers upload their image is called docker hub (https://hub.docker.com/). Let’s try iDEP, one of the most conventional RNA-Seq analysis webtools. docker run --pull always -d --name idep -p 3838:3838 gexijin/idep:latest Note that the Docker engine is now running in the backgroup, acting as a webserver. It works even if you restart your computer. To stop it, run these from Windows PowerShell: This also works for macOS terminal. docker stop idep docker rm idep As a repeat, docker steals your computer resource automatically. You have to shut the containers or app down. You can press Quit Docker Desktop without typing commands to stop docker. Error occured? Below is a typical error beginners encounter. This is because Docker system does not wake up on your computer. Click your app icon and wake it up! docker run -d -p 80:80 docker/getting-started docker: Cannot connect to the Docker daemon at unix:///var/run/docker.sock. Is the docker daemon running?. See 'docker run --help'."
  },"/pages/20240829-TCC-GUI/": {
    "title": "RNASeqChef",
    "keywords": "Packages",
    "url": "/pages/20240829-TCC-GUI/",
    "body": "Description Ref: Github Ref: A web-based integrative transcriptome analysis, RNAseqChef, uncovers the cell/tissue type-dependent action of sulforaphane RNAseqChef, RNA-seq data controller highlighting gene expression features, a web-based platform of systematic transcriptome analysis which can automatically detect, integrate, and visualize the differentially expressed genes and their biological function without bioinformatics skills. Furthermore, Users can analyze not only a single dataset but also integrate and evaluate multiple datasets. Docker commands docker run --rm -p 3838:3838 omicschef/rnaseqchef:latest JPN demo: YouTube Pros Ongoing maintenance Great visualization in pair-wise or 3 conditions DEG Actions are light Can manage promoter motif analysis TogoTV is available in Japanese Cons Difficulty in multi DEGs Less citations Only Japanese movie manual available"
  },"/pages/20240829-iDEP/": {
    "title": "RNASeqChef",
    "keywords": "Packages",
    "url": "/pages/20240829-iDEP/",
    "body": "Description Ref: Github Ref: A web-based integrative transcriptome analysis, RNAseqChef, uncovers the cell/tissue type-dependent action of sulforaphane RNAseqChef, RNA-seq data controller highlighting gene expression features, a web-based platform of systematic transcriptome analysis which can automatically detect, integrate, and visualize the differentially expressed genes and their biological function without bioinformatics skills. Furthermore, Users can analyze not only a single dataset but also integrate and evaluate multiple datasets. Docker commands docker run --rm -p 3838:3838 omicschef/rnaseqchef:latest JPN demo: YouTube Pros Ongoing maintenance Great visualization in pair-wise or 3 conditions DEG Actions are light Can manage promoter motif analysis TogoTV is available in Japanese Cons Difficulty in multi DEGs Less citations Only Japanese movie manual available"
  },"/pages/20240829-metaanalysis/": {
    "title": "RNASeqChef",
    "keywords": "Packages",
    "url": "/pages/20240829-metaanalysis/",
    "body": "NCBI GEOを使ってメタ解析を行う Documented by Ryo Niwa メタ解析のワークフロー Bulk RNA-Seqメタ解析の重要ステップ 1. データ収集 公的データベースの利用: GEO (Gene Expression Omnibus) から取得する データセットの選択基準の設定: 研究目的に合わせて、条件（例：組織タイプ、疾病状態、技術的変数など）を決定する。基本的に比較する際は、合わせられるものは統一したほうが良い。RNA-Seqはただでさえばらつくので、生物種や細胞株など統一可能な範囲では努力する。 AIツールに頼る:ResearchRabbit, ConnectedPapersあたりは非常に優れている。 2. データ前処理 TSVファイルの確認: GEOからダウンロードしたTSVファイルを確認し、必要なメタデータを取得する。2023年ごろよりGEOに登録されたヒト検体RNA-Seqは全てNCBIが規格化された手法で解析し、登録後1週間程度でカウントデータがアップされている。 参考1: https://www.ncbi.nlm.nih.gov/geo/info/rnaseqcounts.html 参考2: https://academic.oup.com/nar/article/52/D1/D138/7337616 :::info SRAの実行データのうち、生物種がヒト（Homo sapiens）で、タイプがトランスクリプトミクスのものは、HISAT2を用いてゲノムアセンブリGCA_000001405.15にアライメントされる。50%以上のアライメント率を達成した実行データは、SubreadのfeatureCountsでさらに処理され、各実行データに対する生データカウントファイルが生成される。 生データカウントマトリックス内の値は、一般的な差次的発現解析ソフトウェアに適した入力となるように四捨五入される。GEOは、生データカウントを入力として、FPKM(RPKM)およびTPMで規格化された値を計算する。 ::: 3. データセットの結合 Rなどで行う: Rなどを用いて、データセットを結合する。Excelで力技でやっても構わない。RNA-Seqに存在するBatch effectを修正して解析を行う場合もあるが、大体の結論を導き出すだけであれば基本的には不要。 最低限のQC: DegustやiDEPなどを用いて全体を俯瞰し、解析している検体が確からしいかどうかを見ておくと良い。これらを使ってDEGsを見ても良いが、今回は必要なさそうなので割愛。GEO2Rでも中身は確認できるので、それでもOK。全体のカウント値が大幅に外れていなければ問題ない。 https://togotv.dbcls.jp/en/20230328.html"
  },"/pages/2024-08-29-hoge/": {
    "title": "hoge",
    "keywords": "hoge",
    "url": "/pages/2024-08-29-hoge/",
    "body": "Aim for this page Understand methods to process a count matrix data"
  },"/rna-seq/2024-08-28-processing-count-matrix.html": {
    "title": "How can I know DEGs?",
    "keywords": "RNA-Seq",
    "url": "/rna-seq/2024-08-28-processing-count-matrix.html",
    "body": "Aim for this page Understand methods to process a count matrix data Quick answer of this page: DESeq2/edgeR Once you obtain a count matrix, there are a couple of tools available to process the count matrix to extract DEGs (differentially expressed genes). The big two legends in this field are edgeR and DESeq2, cited almost 40000 and 70000 times respectively. Robinson MD, McCarthy DJ, Smyth GK. edgeR: a Bioconductor package for differential expression analysis of digital gene expression data. Bioinformatics. 2010 Jan 1;26(1):139-40. doi: 10.1093/bioinformatics/btp616. Love, M.I., Huber, W. &amp; Anders, S. Moderated estimation of fold change and dispersion for RNA-seq data with DESeq2. Genome Biol 15, 550 (2014). https://doi.org/10.1186/s13059-014-0550-8 But why do we need to use this kind of tools? The training seminar at the Harvard Chan Bioinformatics Core documents the uniqueness of RNA-Seq statistics as follows. the count data generated by RNA-seq exhibits overdispersion (variance &gt; mean) and the statistical distribution used to model the counts needs to account for this overdispersion. The Poisson distribution is commonly used for standard count data and is suitable for data with low variability. However, for data like RNA-Seq, where expression levels can vary greatly depending on conditions, the Poisson distribution is not appropriate. The negative binomial distribution can handle greater variability than the Poisson distribution, making it more suitable for RNA-Seq count data. For comparing gene expression between samples using visualizations such as box plots or scatter plots, normalization to TPM (Transcripts Per Million) is convenient. However, DESeq2 and edgeR use different assumptions and perform their own internal normalization. Therefore, when using these tools, it is necessary to provide raw count matrices. DESeq2 uses median of ratios as internal normalization method and edgeR deploys trimmed mean of M values (TMM). Both of the methods are considered reliable, but their assumptions are different. Aspect DESeq2’s Median of Ratios edgeR’s Trimmed Mean of M-values (TMM) Approach Uses the median of ratios of gene counts between samples. Calculates the log-fold changes (M-value), trims genes with the extreme M values, and then computes the mean of the trimmed M-values. Robustness Handles outliers and large numbers of differentially expressed genes well. Reduces the impact of outliers and adjusts for differences in sequencing depth and composition. Both packages have appropriate Hypothesis testing and Multiple test correction like Wald test and Benjamini-Hochberg in DESeq2. The packages spit out DEGs over your defined thereshold."
  },"/rna-seq/2024-08-26-normalization.html": {
    "title": "How can I normalize RNA-Seq count matrix?",
    "keywords": "RNA-Seq",
    "url": "/rna-seq/2024-08-26-normalization.html",
    "body": "Aim for this page Understand methods of normalization in RNA-Seq Quick answer of this page: Use TPM first Before discussing this topic, this QA is must-read! RPKM and FPKM are virtually the same concept. RPKM is basically for single-end sequencing and FPKM is for pair-end sequencing. With paired-end RNA-seq, two reads can correspond to a single fragment, or, if one read in the pair did not map, one read can correspond to a single fragment. The only difference between RPKM and FPKM is that FPKM takes into account that two reads can map to one fragment (and so it doesn’t count this fragment twice). For RPKM (Reads Per Kilobase Million): \\[\\text{RPKM} = \\frac{\\text{Number of reads mapped to a gene}}{\\text{Total reads in sample} \\times 10^{-6}} \\times \\frac{10^3}{\\text{Length of gene in bp}}\\] For FPKM (Fragments Per Kilobase Million): \\[\\text{FPKM} = \\frac{\\text{Number of fragments mapped to a gene}}{\\text{Total fragments in sample} \\times 10^{-6}} \\times \\frac{10^3}{\\text{Length of gene in bp}}\\] For TPM, there are two steps: Calculate RPK (Reads Per Kilobase): \\[\\text{RPK} = \\frac{\\text{Number of reads mapped to a gene}}{\\text{Length of gene in kb}}\\] Calculate TPM (Transcripts Per Kilobase Million): \\[\\text{TPM} = \\frac{\\text{RPK for a gene} \\times 10^6}{\\text{Sum of all RPK values in the sample}}\\] when calculating TPM, the only difference is that you normalize for gene length first, and then normalize for sequencing depth second. However, the effects of this difference are quite profound. When you use TPM, the sum of all TPMs in each sample are the same. This makes it easier to compare the proportion of reads that mapped to a gene in each sample. In contrast, with RPKM and FPKM, the sum of the normalized reads in each sample may be different, and this makes it harder to compare samples directly. Examples and details Let’s try some examples from this blog. Example table: length 1000 bp 1200 bp 800 bp 500 bp 2000 bp sample A (count) 20 30 20 50 150 sample B (count) 100 60 140 120 180 Results (computed by claude): Transcript Length 1000 bp 1200 bp 800 bp 500 bp 2000 bp Total Sample A (Read Count) 20 30 20 50 150 270 FPKM (A) 74,074 92,593 92,593 370,370 277,778 907,408 TPM (A) 81,633 102,041 102,041 408,163 306,122 1,000,000 Sample B (Read Count) 100 60 140 120 180 600 FPKM (B) 166,667 83,333 291,667 400,000 150,000 1,091,667 TPM (B) 152,672 76,336 267,176 366,412 137,404 1,000,000 Why are FPKM and TPM different? Wagner, G.P., Kin, K. &amp; Lynch, V.J. Measurement of mRNA abundance using RNA-seq data: RPKM measure is inconsistent among samples. Theory Biosci. 131, 281–285 (2012). https://doi.org/10.1007/s12064-012-0162-3 The reason for the inconsistency of RPKM across samples arises from the normalization by the total number of reads. While rmc as well as qPCR results are ratios of transcript concentrations, the RPKM normalizes a proxy for transcript number by \\[\\frac{r_g \\cdot 10^3}{l_g \\cdot \\frac{R}{10^6}}\\] the number of sequencing reads in millions, \\[\\frac{R}{10^6}\\] The latter, however, is not a measure of total transcript number. The relationship between \\(R\\) and the total number of transcripts sampled depends on the size distribution of RNA transcripts, which can differ between samples. In a sample with, on average, longer transcripts the same number of reads represents fewer transcripts. While TPM is essentially the ratio of each gene’s RPK to the total RPK, RPKM (FPKM) can be considered as the ratio of each gene’s RPK to the total number of reads. When longer genes have more reads, the overall RPK effectively becomes smaller, resulting in a discrepancy in the total values. Also please note that when you perform DEG (differentally expressed gene) analysis, you need to put different assumptions. While TPM is useful to compare gene count internally or externally, previous studies suggested DEG analysis require other statistical models."
  },"/rna-seq/2024-08-26-basic-analysis.html": {
    "title": "What kind of magic does a bioinformatician perform to convert fastq to count matrix?",
    "keywords": "RNA-Seq",
    "url": "/rna-seq/2024-08-26-basic-analysis.html",
    "body": "Aim for this page Understand the basic of RNA-Seq analysis Quick answer of this page: Mapping, quantification, normalization Must-read paper: RNA sequencing: the teenage years Stark, R., Grzelak, M. &amp; Hadfield, J. RNA sequencing: the teenage years. Nat Rev Genet 20, 631–656 (2019). https://doi.org/10.1038/s41576-019-0150-2 Phase 1 — alignment/mapping of sequencing reads After sequencing has been completed, the starting point for analysis is the data files, which contain base-called sequencing reads, usually in the form of FASTQ files. The most common first step in processing these files is to map sequence reads to a known transcriptome (or annotated genome), converting each sequence read to one or more genomic coordinates. This process has traditionally been accomplished using distinct alignment tools, such as TopHat, STAR or HISAT, which rely on a reference genome. People typically call this first step, alignment or mapping. Long story in short, mapping means: Mostly we use reference genomes such as GRCh38 for the reference in mapping. In NCBI, SRA runs where the organism is Homo sapiens and type is Transcriptomic are aligned to genome assembly GCA_000001405.15 (link) using HISAT2. A. Bianchi, A. Di Marco and C. Pellegrini, “Comparing HISAT and STAR-based pipelines for RNA-Seq Data Analysis: a real experience,” 2023 IEEE 36th International Symposium on Computer-Based Medical Systems (CBMS), L’Aquila, Italy, 2023, pp. 218-224, doi: 10.1109/CBMS58004.2023.00220. The paper above describes two major mapping tools in RNA-Seq field, STAR and HISAT. HISAT2 uses graph FM index (GFM), has a smaller index size, is faster but has limited multi-threading capabilities, and is optimized for both single-end and paired-end reads. STAR2 uses Spliced Transcripts Alignment as a reference algorithm, has a larger index size, higher sensitivity, and better multi-threading, but it is slower, and it is optimized for spliced reads. Each algorithm creates distinct characteristics in mapping. It has been noted that different mapping tools can lead to variations in the identification of DEGs (differentially expressed genes). It is important to choose the appropriate tool based on one’s available computational resources, the volume of data to be processed, and the specific research objectives. DO NOT USE TopHat anymore even it was a legend Developers tweeted (maybe I should say ‘posted’) “Please stop using Tophat” multuiple times. https://x.com/lpachter/status/937055346987712512 https://x.com/lpachter/status/1762004715678957910 HISAT2 is the one you should use if you want to use Tophat-like mapping. Assembly of transcripts - why? Some analysis pipeline deploys StringTie as an assembler of transcripts. The main reason is this paper published on nature protocols. Pertea, M., Kim, D., Pertea, G. et al. Transcript-level expression analysis of RNA-seq experiments with HISAT, StringTie and Ballgown. Nat Protoc 11, 1650–1667 (2016). https://doi.org/10.1038/nprot.2016.095 Due to alternative splicing, a single gene can produce multiple types of transcripts. Therefore, when estimating gene expression levels from mapping results, you can decide whether you ignore transcript isoforms and counts per gene (gene-level quantification), or consider isoforms and count for each isoform separately (transcript-level quantification). De novo assembler such as StringTie makes isoform quantification possible. https://ccb.jhu.edu/software/stringtie/index.shtml?t=faq Phase 2 — quantification of transcript abundance Once reads have been mapped to genomic or transcriptomic locations, the next step in the analysis process is to assign them to genes or transcripts, to determine abundance measures. Diverse comparative studies have shown that the approach taken at the quantification step has perhaps the largest impact on the ultimate results, even greater than the choice of aligner. The quantification of read abundances for individual genes (that is, all transcript isoforms for that gene) relies on counting sequence reads that overlap known genes, using a transcriptome annotation. The next step is to count how many times genes are sequenced. Some methods are available here including HTSeq and RSEM. There are a couple of papers testing differences (The list below is a few examples). Chandramohan R, Wu PY, Phan JH, Wang MD. Benchmarking RNA-Seq quantification tools. Annu Int Conf IEEE Eng Med Biol Soc. 2013;2013:647-50. doi: 10.1109/EMBC.2013.6609583. Corchete LA, Rojas EA, Alonso-López D, De Las Rivas J, Gutiérrez NC, Burguillo FJ. Systematic comparison and assessment of RNA-seq procedures for gene expression quantitative analysis. Sci Rep. 2020 Nov 12;10(1):19737. doi: 10.1038/s41598-020-76881-x. Wu, D., Yao, J., Ho, K. et al. Limitations of alignment-free tools in total RNA-seq quantification. BMC Genomics 19, 510 (2018). https://doi.org/10.1186/s12864-018-4869-5 Here are the general ideas of two major tools. Please note that the table below is not always true depending on users’ options. Characteristic HTSeq (featureCounts) RSEM Algorithm Simple counting method Probability model-based estimation Multi-mapping reads Ignored or equally distributed Probabilistically assigned Isoform quantification Not supported Supported Use case Simple gene expression analysis Detailed transcriptome analysis The figure on HTSeq website illustrates how case divisions in mappingis complicated. Phase 3 — filtering and normalization Nomalization is documented in a different post."
  },"/rna-seq/2024-08-23-databases.html": {
    "title": "What kind databases are available in RNA-Seq studies?",
    "keywords": "RNA-Seq",
    "url": "/rna-seq/2024-08-23-databases.html",
    "body": "Aim for this page Know what kind of databases in expression analysis are available Quick answer of this page: Raw=SRA, Processed=GEO I want you to recoginie two important databases, SRA and GEO. Typical differences of the 2 databases: Aspect SRA (Sequence Read Archive) GEO (Gene Expression Omnibus) Purpose Raw sequence data repository Functional genomics data repository Data type Raw sequencing data (fastq, bam) Processed data, metadata, and raw data links Scope All sequencing platforms and applications Primarily gene expression data, but includes other functional genomics data Data size Typically larger files (raw data) Usually smaller files (processed data) Search capability Sequence-based searches Expression and metadata-based searches SRA description: https://www.ncbi.nlm.nih.gov/sra/docs/ GEO description: https://www.ncbi.nlm.nih.gov/geo/info/overview.html Databases are linked to each other GSE275240 is our lab’s previous paper’s data accession ID. This GSE275240 is connected to another database called BioProject under PRJDB15620. BioProject contains SRA Run as sequence data and BioSample to explain what each sequence data is derived from. Certainly. SRA ‘Experiment’ describes the sequencing library derived from a specific sample and the sequencing method used. Much of the publicly available information about the data is recorded in the Experiment. SRA ‘Run’ is an object that groups together data files that should be linked to an Experiment. It contains little descriptive information about the data itself. All data files listed in a Run are merged into an SRA file for archiving (and into fastq files for distribution). Database structure This is an overall structure of SRA/BioSample/BioProject. The picture below is cited from DDBJ. Since it does not contain GEO, I just added in a mermaid plot. BioProject is a database designed to organize research projects and their associated data. By citing the BioProject accession number, data can be grouped on a project-by-project basis. BioSample and GEO Sample (GSM) ultimately explains the identical information. graph TD subgraph BioProject[\"BioProject\"] BP[BioProject PRJD] end subgraph BioSample[\"BioSample\"] BS1[BioSample SAMD] BS2[BioSample SAMD] BS3[BioSample SAMD] end subgraph SRA[\"Sequence Read Archive\"] E[Experiment SRX-DRX] E --&gt; LL[\"Library layout\"] E --&gt; SP[\"Sequencing platform\"] R1[Run SRR-DRR] R2[Run SRR-DRR] R3[Run SRR-DRR] SDF[\"Sequence data files fastq, BAM\"] R1 -.-&gt; SDF R2 -.-&gt; SDF R3 -.-&gt; SDF end subgraph GEO[\"Gene Expression Omnibus\"] GSE[GEO Series GSE] GSM1[GEO Sample GSM] GSM2[GEO Sample GSM] GSM3[GEO Sample GSM] GSE --&gt; GSM1 GSE --&gt; GSM2 GSE --&gt; GSM3 GSM3 --&gt; GD[\"Gene expression data\"] end BP --&gt; BS1 BP --&gt; BS2 BP --&gt; BS3 BP --&gt; E BP --&gt; GSE GSM1 -.-&gt; R1 GSM2 -.-&gt; R2 GSM3 -.-&gt; R3 BS1 --&gt; E BS2 --&gt; E BS3 --&gt; E E --&gt; R1 E --&gt; R2 E --&gt; R3 classDef bioproject fill:#e6ffe6,stroke:#333,stroke-width:2px; classDef biosample fill:#fff0e6,stroke:#333,stroke-width:2px; classDef sra fill:#e6e6ff,stroke:#333,stroke-width:2px; classDef geo fill:#ffe6e6,stroke:#333,stroke-width:2px; class BP,PD,G,Pub bioproject; class BS1,BS2,BS3,SD biosample; class E,LL,SP,R1,R2,R3,DF,SDF sra; class GSE,GSM1,GSM2,GSM3,GD geo; style BioProject fill:#e6ffe6,stroke:#333,stroke-width:4px; style BioSample fill:#fff0e6,stroke:#333,stroke-width:4px; style SRA fill:#e6e6ff,stroke:#333,stroke-width:4px; style GEO fill:#ffe6e6,stroke:#333,stroke-width:4px; DRA/SRA differences? DRA (DDBJ Sequence Read Archive) is an archive of raw read sequences and maintained by DDBJ. DRA (DDBJ Sequence Read Archive) is a member of the International Nucleotide Sequence Database Collaboration (INSDC) and is operated in international cooperation with NCBI SRA and EBI Sequence Read Archive (ERA). The data is mirrored (synchronized). If you can find the same dataset in SRA and DRA, downloading from DRA is geographically much faster."
  },"/rna-seq/2024-08-23-count.html": {
    "title": "How do you obtain the count matrix of public RNA-Seq data?",
    "keywords": "RNA-Seq",
    "url": "/rna-seq/2024-08-23-count.html",
    "body": "Aim for this page Know NCBI’s service: auto-generated RNA-seq count data Quick answer of this page: Use NCBI generated RNA-seq count data You are very fortunate. NCBI launched a new service to make the count matrix of RNA-Seq available! Count data generation occurs under the following conditions: 1. The sample is registered in the Sequence Read Archive (SRA) 2. The sample is registered in the Gene Expression Omnibus (GEO) 3. The sample is derived from either human or mouse A count matrix is automatically generated approximately one week after sample registration. For each GEO Series, two main types of files are generated, raw counts and normalized counts. RNA-seq Raw Count Matrix: Aspect Description Format Tab-delimited text file Purpose Suitable for input into differential expression analysis tools like DESeq2, edgeR, or limma voom RNA-seq Normalized Count Matrix: Aspect Description Format Tab-delimited text file Purpose Suitable for qualitative analysis and visualization of gene expression abundance Normalization FPKM (RPKM) and TPM How does the analysis work? NCBI uses HISAT2 and featureCounts. Details are here. Do you want to know what each software manage? Go to a next post Briefly, SRA runs where the organism is Homo sapiens and type is Transcriptomic are aligned to genome assembly GCA_000001405.15 using HISAT2. Runs that pass a 50% alignment rate are further processed with Subread featureCounts which outputs a raw count file for each run. For Human data, the Homo sapiens Annotation Release 109.20190905 was used for gene annotation. GEO further processes these SRR raw count files into GEO Series raw counts matrices. Data derived from single cell samples are skipped. In cases where there is more than one SRA run per GEO Sample, the raw counts are summed. Values in the raw count matrices are rounded so that they are compatible input for common differential expression analysis software. Using the raw counts as input, GEO then computes FPKM(RPKM) and TPM normalized values. This way of the output is Atarimae (natural) in RNA-Seq field Please note that our in-house RNA-Seq pipeline provides the same format of results as a paper below saying The results of the quantification step are usually combined into an expression matrix, with a row for each expression feature (gene or transcript) and a column for each sample, with the values being either actual read counts or estimated abundances. Stark, R., Grzelak, M. &amp; Hadfield, J. RNA sequencing: the teenage years. Nat Rev Genet 20, 631–656 (2019). https://doi.org/10.1038/s41576-019-0150-2 You need to handle these data by yourself for data exploration anyway."
  }}
